package pipeline

import (
	"github.com/yoojia/edgex"
)

//
// Author: 陈哈哈 yoojiachen@gmail.com
//

func main() {
	edgex.Run(func(ctx edgex.Context) error {
		// 向系统注册节点
		pipeline, ri := ctx.NewPipeline(edgex.PipelineOptions{
			Name: "EXAMPLE-DRIVER",
			Topics: []string{
				"/examples/+/tcp",
				"/examples/+/udp",
			},
		})

		for {
			select {
			case in := <-pipeline.Incomes():
				// 接收到消息，并处理。
				pipeline.Forward(in)

			case err := <-ctx.WaitCh():
				return err

			}
		}

	})
}
